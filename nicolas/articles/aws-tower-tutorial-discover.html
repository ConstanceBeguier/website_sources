<!DOCTYPE html>
<html xmlns:og="http://ogp.me/ns#" lang="en" class="h-100">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="TODO" />
    <meta name="author" content="Nicolas Béguier" />
    <meta name="keywords" content="aws tower security audit opensource" />
    <meta property="og:title" content="AWS Tower Tutorial: Setup guide" />
    <meta property="og:image" content="https://beguier.eu/nicolas/img/cover/nginx-2023.jpg" />
    <meta property="og:description" content="TODO" />
    <meta property="og:url" content="https://beguier.eu/nicolas/articles/aws-tower-tutorial-setup-guide.html" />
    <meta property="og:type" content="article" />
    <title>AWS Tower Tutorial: Discover</title>
    <script src="/js/redirect.min.js" type="text/javascript" async></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/css/beguier.min.css" rel="stylesheet" />
    <link href="/css/gist.min.css" rel="stylesheet" />
    <link rel="icon" href="/favicon.png" />
  </head>

  <body class="d-flex flex-column h-100 bg-black">
    <!-- Begin nav header -->
    <div id="includedNavbar">
      <header class="p-3 border-bottom bg-white" />
    </div>

    <!-- Begin article body -->
    <main class="flex-shrink-0">
      <div class="container col-lg-8 p-0 bg-dark text-light">
        <!-- Begin title banner -->
        <div
          class="position-relative overflow-hidden text-center"
          style="background: url('/nicolas/img/logo/aws-tower-logo.svg') center no-repeat; background-color: rgba(0, 0, 0, 0.68) !important; background-blend-mode: overlay; background-size: cover;"
        >
          <div class="col-md-6 m-5 mx-md-auto">
            <h1 class="display-4 fw-normal">AWS Tower Tutorial</h1>
            <p class="lead fw-normal">
              Discover
            </p>
          </div>
        </div>
        <!-- Begin article content -->
        <div class="p-5">
          <p class="text-muted">Jan 1st, 2023 by Nicolas Béguier</p>

          <div id="includedAWSTowerSummary"></div>

          <h1 class="my-5 fs-3">Discover</h1>

          <p>AWS Tower highlights the assets of an account: API Gateway, Cloudfront, EC2, EKS, ELB, IAM role, RDS, S3 bucket, VPC.</p>

          <p>Displays <b>security-related</b> information, so that even an <b>AWS novice</b> can understand if there is a security issue or not.</p>

          <h2 class="my-5 fs-4">Usage</h2>

          <div class="text-code">
            <span class="text-info">aws-tower</span> discover <span class="text-warning">--help</span><br />
            usage: aws_tower_cli.py discover [-h] [-t {APIGW,CLOUDFRONT,EC2,EKS,ELB,IAM,RDS,S3,VPC}] [-p] [-f FILTER] [-v] [-b] [-s] profile<br />
            <br />
            positional arguments:<br />
            &nbsp;&nbsp;<span class="text-warning">profile</span> A valid profile name configured in the ~/.aws/config file<br />
            <br />
            options:<br />
            &nbsp;&nbsp;<span class="text-warning">-h, --help</span> show this help message and exit<br />
            &nbsp;&nbsp;<a class="link-warning" href="#type">-t {APIGW,CLOUDFRONT,EC2,EKS,ELB,IAM,RDS,S3,VPC}, --type {APIGW,CLOUDFRONT,EC2,EKS,ELB,IAM,RDS,S3,VPC}</a><br />
            &nbsp;&nbsp;&nbsp;&nbsp;Types to display (default: display everything)<br />
            &nbsp;&nbsp;<a class="link-warning" href="#public-only">-p, --public-only</a> Display public assets only<br />
            &nbsp;&nbsp;<a class="link-warning" href="#filter">-f FILTER, --filter FILTER</a><br />
            &nbsp;&nbsp;&nbsp;&nbsp;Filter by asset value (Ex: "something", "port:xxx", "engine:xxx", "version:xxx"<br />
            &nbsp;&nbsp;<span class="text-warning">-v, --verbose</span> Verbose output of the account assets<br />
            &nbsp;&nbsp;<a class="link-warning" href="#brief">-b, --brief</a> Brief output of the account assets<br />
            &nbsp;&nbsp;<a class="link-warning" href="#summary">-s, --summary</a> Summary of the account assets<br />
            &nbsp;&nbsp;<a class="link-warning" href="#output">-o OUTPUT, --output OUTPUT</a> Save the JSON output inside the specified file<br />
          </div>
          <br />

          <h2 class="my-5 fs-4" id="type">Option <span class="text-code">--type</span></h2>

          <p>
            The '<span class="text-code">--type</span>' option, or the '<span class="text-code">-t</span>' flag, allows us to choose specific asset types from the list: APIGW, CLOUDFRONT, EC2, EKS, ELB, IAM, RDS, S3, and VPC. For example,
            APIGW refers to the API Gateway, while ELB covers Application Load Balancers (ALBs) and Network Load Balancers (NLBs). The VPC option relates to networking features like VPC peering and VPN connections.
          </p>

          <b>Examples</b>

          <div class="text-code">
            <span class="text-secondary"># This command list all S3 buckets in demo-account profile.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span> --type S3<br />
          </div>
          <div class="text-code">
            <span class="text-secondary"># This command list EC2 and ELB.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span> --type EC2 --type ELB<br />
          </div>

          <div class="text-code">
            <span class="text-secondary"># Without any parameter, it returns all asset types.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span><br />
          </div>

          <h2 class="my-5 fs-4" id="public-only">Option <span class="text-code">--public-only</span></h2>

          <p>
            The '<span class="text-code">--public-only</span>' option, or the '<span class="text-code">-p</span>' flag, is a boolean (on/off) parameter that enables us to show only publicly reachable assets. Public assets can be contacted
            from the internet and have a port that is open to external connections. Certain assets, such as API Gateway, Cloudfront, EC2, ELB, EKS, RDS, and S3, can be wrongly configured and made accessible to the internet if not properly
            protected.
          </p>

          <b>Examples</b>

          <div class="text-code">
            <span class="text-secondary"># This command display all public EC2, which means they are in a public subnet with a dedicated public IP address.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span> --type EC2 --public-only<br />
          </div>
          <div class="text-code">
            <span class="text-secondary"># Without any parameter, it returns all asset types, reachable from internet or not.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span><br />
          </div>

          <h2 class="my-5 fs-4" id="filter">Option <span class="text-code">--filter</span></h2>

          <p>The '<span class="text-code">--filter</span>' option, or the '<span class="text-code">-f</span>' flag, is a way to limit the displayed assets. Here is the list of implemented quick filters</p>

          <table>
            <tr>
              <th>Filter name</th>
              <th>Related asset types</th>
            </tr>
            <tr>
              <td>port</td>
              <td>ELB, EC2</td>
            </tr>
            <tr>
              <td>engine</td>
              <td>RDS</td>
            </tr>
            <tr>
              <td>version</td>
              <td>EKS, RDS</td>
            </tr>
            <tr>
              <td>anything</td>
              <td>all</td>
            </tr>
          </table>

          <br />
          <b>Examples</b>

          <div class="text-code">
            <span class="text-secondary"># Display all asset with a 'kibana' in their name.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span> --filter kibana<br />
            "IAM roles": {<br />
            &nbsp;&nbsp;"kibana-demo": "Poweruser actions: ['s3'] "<br />
            },<br />
            "EC2": {<br />
            &nbsp;&nbsp;"kibana-demo": {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;"OS": "Linux/UNIX",<br />
            &nbsp;&nbsp;&nbsp;&nbsp;"PrivateIP": "10.0.0.222",<br />
            &nbsp;&nbsp;&nbsp;&nbsp;"Roles PowerUser": "kibana-demo: ['s3']",<br />
            &nbsp;&nbsp;&nbsp;&nbsp;"SecurityGroups": {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"sg-0479f3d055847ea77": {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"22": [<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"192.168.0.0/16",<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"5601": [<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"sg-07765fc96c2232ed7",<br />
            &nbsp;&nbsp;&nbsp;&nbsp;},<br />
            "ELB": {<br />
            &nbsp;&nbsp;"lb-kibana.elb.eu-west-3.amazonaws.com": {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;"DnsRecord": "kibana-demo.leboncoin.fr.",<br />
            &nbsp;&nbsp;&nbsp;&nbsp;"PubliclyAccessible": "True",<br />
            &nbsp;&nbsp;&nbsp;&nbsp;"Scheme": "internet-facing",<br />
            &nbsp;&nbsp;&nbsp;&nbsp;"SecurityGroups": {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"sg-07765fc96c2232ed7": {<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"443": [<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"0.0.0.0/0"<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br />
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
            &nbsp;&nbsp;&nbsp;&nbsp;}<br />
            &nbsp;&nbsp;}<br />
            }<br />
          </div>

          <div class="text-code">
            <span class="text-secondary"># Display all postgresql in version 12.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span> --filter engine:postgres --filter version:12<br />
          </div>

          <h2 class="my-5 fs-4" id="brief">Option <span class="text-code">--brief</span></h2>

          <p>
            The '<span class="text-code">--brief</span>' option, or the '<span class="text-code">-b</span>' flag, is a boolean (on/off) parameter that enables us to display only necessary information. Each asset will be displayed on a
            single line when this option is enabled. Having a concise summary of a new account is helpful, rather than being inundated with too much information.
          </p>

          <b>Examples</b>

          <div class="text-code">
            <span class="text-secondary"># This command display all asset in demo-account, but without to much information.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span> --brief<br />
          </div>
          <div class="text-code">
            <span class="text-secondary"># Without any parameter, it returns all asset types, with all info related to security. It's formatted in JSON.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span><br />
          </div>

          <h2 class="my-5 fs-4" id="output">Option <span class="text-code">--output</span></h2>

          <p>The '<span class="text-code">--output</span>' option, or the '<span class="text-code">-o</span>' flag, is the path for the report written in JSON.</p>

          <b>Examples</b>

          <div class="text-code">
            <span class="text-secondary"># This command display all asset in demo-account, in /tmp/report.json.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span> --output /tmp/report.json<br />
          </div>
          <div class="text-code">
            <span class="text-secondary"># Without any parameter, it returns the output in the current console.</span><br />
            <span class="text-info">aws-tower</span> discover <span class="text-warning">demo-account</span><br />
          </div>

          <div class="row">
            <div class="col-3 text-center my-3">
              <a href="./aws-tower-tutorial-setup-guide.html" class="btn btn-secondary btn-lg" role="button">Previous: 1. Setup guide</a>
            </div>
            <div class="col"></div>
            <div class="col-3 text-center my-3">
              <a href="./aws-tower-tutorial-audit.html" class="btn btn-secondary btn-lg" role="button">Next: 3. Audit</a>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Begin footer -->
    <div id="includedFooter" class="mt-auto"></div>

    <script src="/js/pub/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script src="/js/nico.min.js"></script>
    <script>
      $("#includedAWSTowerSummary").load("aws-tower-summary.html");
    </script>
  </body>
</html>
